import{M as x,a as g,s as k,E as y,r as f,b as S,d,f as s,P as V,Q as $,q as e,g as C,i as F,F as B,S as D,c,N as p,t as _}from"./index-991ba792.js";import{c as E,a as w,b as N}from"./index.esm-bea02fdb.js";const T=s("h1",{class:"border-bottom mb-4 fs-4 pb-3 fw-medium"},"修改密碼",-1),q={class:"row"},I={class:"col-md-9"},M={key:0,class:"d-flex gap-2 align-items-center"},R=s("label",{class:"form-label",for:"current_password"},"請先輸入目前密碼",-1),A={key:1},O={class:"d-flex flex-column"},Q=s("label",{class:"form-label",for:"password"},"更改密碼",-1),U={class:"text-danger error-text"},j={class:"d-flex flex-column"},z=s("label",{class:"form-label",for:"confirmPassword"},"確認更改密碼",-1),G={class:"text-danger error-text"},H=s("button",{class:"btn btn-dark ms-auto",type:"submit"}," 更改 ",-1),ss={__name:"EditPassword",setup(J){const{errors:a,values:K,setValues:L,handleSubmit:W,defineInputBinds:i,setErrors:X}=x({initialValues:{password:"",confirmPassword:""},validationSchema:E({password:w().required("請勿空白"),confirmPassword:w().oneOf([N("password")],"請確認密碼是否相同")})});g();const b=k();y();const l=f(""),n=f(!1),h=i("password"),v=i("confirmPassword"),P=async(t,o)=>{console.log("[change]",t,o);const r=await D({email:t,password:o,returnSecureToken:!0});r.data?(n.value=!0,localStorage.setItem("token",r.data.idToken)):n.value=!1};return(t,o)=>{const r=S("VeeForm");return c(),d(B,null,[T,s("div",q,[s("div",I,[n.value===!1?(c(),d("div",M,[s("div",null,[R,V(s("input",{"onUpdate:modelValue":o[0]||(o[0]=u=>l.value=u),placeholder:"請輸入目前密碼",class:"form-control",type:"password",id:"current_password"},null,512),[[$,l.value]])]),s("button",{onClick:o[1]||(o[1]=u=>{var m;return P((m=e(b).userData)==null?void 0:m.email,l.value)}),type:"button",class:"btn btn-dark mt-auto"}," 確認 ")])):(c(),d("div",A,[C(r,{class:"d-flex flex-column gap-3",onSubmit:t.submit},{default:F(()=>[s("div",O,[Q,s("input",p({class:`form-control ${e(a).password&&"is-invalid"}`},e(h),{type:"password",name:"password",id:"password",placeholder:"請輸入更改密碼"}),null,16),s("small",U,_(e(a).password&&e(a).password),1)]),s("div",j,[z,s("input",p({class:`form-control ${e(a).confirmPassword&&"is-invalid"}`},e(v),{type:"password",name:"confirmPassword",id:"confirmPassword",placeholder:"請次確認更改密碼"}),null,16),s("small",G,_(e(a).confirmPassword&&e(a).confirmPassword),1)]),H]),_:1},8,["onSubmit"])]))])])],64)}}};export{ss as default};
