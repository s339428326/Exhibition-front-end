import{_ as N,v as I,s as C,b as m,d as _,f as e,n as h,F as k,h as w,g as s,i as c,t as o,O as T,c as x,H as y,p as H,k as S}from"./index-d614a8a0.js";import{c as j}from"./order-c94ecb2a.js";const U={data(){return{cartDataInstance:I(),user:C(),page:1,form:{email:"",name:"",tel:"",address:"",cardNumber:"",cardName:"",cvc:""}}},created(){this.cartDataInstance.initCartData()},methods:{async onSubmit(n){var i;n.preventDefault();let a=0;this.cartDataInstance.cartData.forEach(u=>{a+=u.ticketType.price*(u==null?void 0:u.quantity)});try{const u=await j({localId:(i=this.user.userData)==null?void 0:i.localId,name:this.form.name,address:this.form.address,total:a,orderList:this.cartDataInstance.cartData});localStorage.removeItem("cart")}catch(u){console.log(u)}this.cartDataInstance.cartData=[]},pageHandler(n){switch(n){case"add":this.page+=1;break;case"del":if(this.page===1)return;this.page-=1;break}},quantityHandler(n){const{index:a,cal:i}=n.target.dataset;if(this.cartDataInstance.cartData[a].quantity===1&&i==="del")return;const u={...this.cartDataInstance.cartData[a],tickType:{...this.cartDataInstance.cartData[a].tickType},quantity:i==="add"?this.cartDataInstance.cartData[a].quantity+1:i==="del"?this.cartDataInstance.cartData[a].quantity-1:1};this.cartDataInstance.updateCartItem(u,a)}},computed:{total(){let n=0;return this.cartDataInstance.cartData.forEach(a=>{n+=a.ticketType.price*(a==null?void 0:a.quantity)}),n},nextBtnDisable(){return this.page===1}}},d=n=>(H("data-v-b7df47fe"),n=n(),S(),n),B={class:"container mb-5"},E=T('<section class="my-5" data-v-b7df47fe><ul class="d-flex justify-content-between p-4 border rounded-4 bg-gray shadow-sm" data-v-b7df47fe><li class="border-black p-2 after-line" data-v-b7df47fe><p class="border border-black p-2 fw-bold box d-flex align-items-center justify-content-center mx-auto mb-2" data-v-b7df47fe> 1 </p><p class="text-center" data-v-b7df47fe>建立訂單</p></li><li class="flex-grow-1 border-bottom border-2 h-0 mt-4" data-v-b7df47fe></li><li class="border-black p-2" data-v-b7df47fe><p class="border border-black p-2 fw-bold box d-flex align-items-center justify-content-center mx-auto mb-2" data-v-b7df47fe> 2 </p><p class="text-center" data-v-b7df47fe>填寫訂購資料</p></li><li class="flex-grow-1 border-bottom border-2 h-0 mt-4" data-v-b7df47fe></li><li class="border-black p-2" data-v-b7df47fe><p class="border border-black p-2 fw-bold box d-flex align-items-center justify-content-center mx-auto mb-2" data-v-b7df47fe> 3 </p><p class="text-center" data-v-b7df47fe>填寫付款資料</p></li><li class="flex-grow-1 border-bottom border-2 h-0 mt-4" data-v-b7df47fe></li><li class="border-black p-2" data-v-b7df47fe><p class="border border-black p-2 fw-bold box d-flex align-items-center justify-content-center mx-auto mb-2" data-v-b7df47fe> 4 </p><p class="text-center" data-v-b7df47fe>完成訂購</p></li></ul></section>',1),L={class:"row"},F={class:"border rounded-4 shadow-sm p-4 h-100 d-flex flex-column"},M=d(()=>e("h2",{class:"mb-4 fs-4"},"建立訂單",-1)),O={class:"d-flex flex-column gap-4"},P={class:"d-flex gap-4"},Y=["src","alt"],z={class:"d-flex flex-column"},G={class:"fw-medium"},A={class:"d-flex gap-3 align-items-center"},J=["data-index"],K=["data-index"],Q={class:"fs-6 fw-bold"},R=d(()=>e("div",null,null,-1)),W={class:"flex-grow-1 d-flex"},X={class:"border p-3 rounded-4 shadow-sm"},Z=d(()=>e("h2",{class:"fs-4 mb-3 fw-medium"},"訂購資料",-1)),$={class:"mt-4 d-flex gap-4"},ee=d(()=>e("button",{class:"btn btn-dark w-100",type:"submit"}," 下一步 ",-1)),le={class:"border p-3 rounded-4 shadow-sm"},ae=d(()=>e("h2",{class:"fs-4 mb-3 fw-medium"},"付款資料",-1)),te={class:"mt-4 d-flex gap-4"},se=d(()=>e("button",{class:"btn btn-dark w-100",type:"submit"}," 下一步 ",-1)),oe={class:"border p-4 rounded-4"},de=d(()=>e("h2",{class:"fs-4 fw-medium mb-3"},"完成訂單",-1)),ne=d(()=>e("h3",{class:"pb-2 mb-4 border-bottom"},"購買明細",-1)),re={class:"d-flex flex-column gap-4 mb-4"},ce={class:"d-flex gap-4 align-items-center"},ue=["src","alt"],be={class:"d-flex flex-column"},fe={class:"fw-medium"},ie={class:"fs-6 fw-bold ms-auto"},pe=d(()=>e("div",null,null,-1)),me=d(()=>e("h3",{class:"pb-2 mb-3 border-bottom"},"訂購資訊",-1)),_e={class:"d-flex flex-column gap-1"},xe={class:"mt-4 d-flex gap-4"},he={class:"col-4 flex-grow-1"},ve={class:"border rounded-4 shadow-sm p-4 d-flex flex-column justify-content-between"},ye=d(()=>e("h2",{class:"fs-4 mb-3"},"訂單摘要",-1)),ge={class:"d-flex flex-column gap-2 mb-4"},ke={class:"d-flex justify-content-between fs-6"},we=d(()=>e("p",null,"小計",-1)),De=d(()=>e("li",{class:"d-flex justify-content-between fs-6"},[e("p",null,"今日節省總金額"),e("p",null,"$ 0 NTD")],-1)),Ve=d(()=>e("li",{class:"d-flex justify-content-between fs-6"},[e("p",null,"運送"),e("p",null,"$ 0 NTD")],-1)),qe=d(()=>e("li",{class:"d-flex justify-content-between fs-6"},[e("p",null,"稅款"),e("p",null,"$ 0 NTD")],-1)),Ne=d(()=>e("div",{class:"mb-4"},[e("label",{for:"cupon",class:"mb-2"}," 優惠碼(未開放) "),e("input",{id:"cupon",class:"w-100 border rounded-1 p-1",placeholder:"請輸入優惠碼",type:"text",disabled:"true"})],-1)),Ie={class:"d-flex justify-content-between align-items-center mb-4"},Ce=d(()=>e("p",{class:"fs-5 fw-medium"},"總金額",-1)),Te={class:"fs-5 fw-medium"};function He(n,a,i,u,t,r){const b=m("b-form-input"),D=m("b-form-invalid-feedback"),V=m("b-form-valid-feedback"),f=m("b-form-group"),g=m("b-form"),q=m("router-link");return x(),_("div",B,[E,e("div",L,[e("section",{class:h(`col-auto col-md-8 mb-4 mb-md-0  flex-grow-1 ${t.page===1?"d-block":"d-none"}`)},[e("div",F,[M,e("ul",O,[(x(!0),_(k,null,w(t.cartDataInstance.cartData,(l,p)=>(x(),_("li",{key:p},[e("div",P,[e("div",null,[e("img",{class:"img-box",src:l==null?void 0:l.image,alt:l==null?void 0:l.name},null,8,Y)]),e("div",z,[e("p",G,o(l==null?void 0:l.name),1),e("small",null,o(l==null?void 0:l.date),1),e("small",null,o(l==null?void 0:l.ticketType.ticketType),1),e("div",A,[e("button",{onClick:a[0]||(a[0]=(...v)=>r.quantityHandler&&r.quantityHandler(...v)),"data-index":p,"data-cal":"del",type:"button",class:"btn border-0 btn-dark"}," - ",8,J),e("p",null,o(l==null?void 0:l.quantity),1),e("button",{onClick:a[1]||(a[1]=(...v)=>r.quantityHandler&&r.quantityHandler(...v)),"data-index":p,"data-cal":"add",type:"button",class:"btn border-0 btn-dark"}," + ",8,K)]),e("p",Q," NT$ "+o((l==null?void 0:l.price)*(l==null?void 0:l.quantity)),1)]),R])]))),128))]),e("div",W,[e("button",{onClick:a[2]||(a[2]=l=>r.pageHandler("add")),class:"btn btn-dark w-100 border mt-auto",type:"button"}," 下一步 ")])])],2),e("div",{class:h(`col-auto col-md-8 mb-4 mb-md-0  flex-grow-1 ${t.page===2?"d-block":"d-none"}`)},[e("div",X,[s(g,{class:"row",onSubmit:a[8]||(a[8]=l=>r.pageHandler("add"))},{default:c(()=>[Z,s(f,{id:"name",class:"col-auto col-6 mb-2",label:"收件人","label-for":"name"},{default:c(()=>[s(b,{id:"username",modelValue:t.form.name,"onUpdate:modelValue":a[3]||(a[3]=l=>t.form.name=l),type:"name",placeholder:"請輸入收件人",required:""},null,8,["modelValue"]),s(D,null,{default:c(()=>[y(" 請輸入收件人 ")]),_:1}),s(V,null,{default:c(()=>[y(" Looks Good. ")]),_:1})]),_:1}),s(f,{class:"col-auto col-6",id:"tel",label:"電話","label-for":"tel"},{default:c(()=>[s(b,{id:"tel",modelValue:t.form.tel,"onUpdate:modelValue":a[4]||(a[4]=l=>t.form.tel=l),type:"tel",placeholder:"請輸入電話",required:""},null,8,["modelValue"])]),_:1}),s(f,{class:"col-12 mb-2",id:"address",label:"地址","label-for":"address"},{default:c(()=>[s(b,{id:"address",modelValue:t.form.address,"onUpdate:modelValue":a[5]||(a[5]=l=>t.form.address=l),type:"text",placeholder:"請輸入地址",required:""},null,8,["modelValue"])]),_:1}),s(f,{class:"col-12",id:"email",label:"信箱","label-for":"email"},{default:c(()=>[s(b,{id:"email",modelValue:t.form.email,"onUpdate:modelValue":a[6]||(a[6]=l=>t.form.email=l),type:"email",placeholder:"請輸入信箱",required:""},null,8,["modelValue"])]),_:1}),e("div",$,[e("button",{onClick:a[7]||(a[7]=l=>r.pageHandler("del")),class:"btn btn-dark w-100",type:"button"}," 上一步 "),ee])]),_:1})])],2),e("div",{class:h(`col-auto col-md-8 mb-4 mb-md-0  flex-grow-1  ${t.page===3?"d-block":"d-none"}`)},[e("div",le,[s(g,{class:"row",onSubmit:a[14]||(a[14]=l=>r.pageHandler("add"))},{default:c(()=>[ae,s(f,{id:"cardName",class:"col-12 mb-2",label:"持卡人姓名","label-for":"cardName"},{default:c(()=>[s(b,{id:"card",modelValue:t.form.cardName,"onUpdate:modelValue":a[9]||(a[9]=l=>t.form.cardName=l),type:"card",placeholder:"請輸入持卡人姓名",required:""},null,8,["modelValue"])]),_:1}),s(f,{id:"cardNumber",class:"col-12 mb-2",label:"信用卡","label-for":"cardNumber"},{default:c(()=>[s(b,{id:"cardNumber",modelValue:t.form.cardNumber,"onUpdate:modelValue":a[10]||(a[10]=l=>t.form.cardNumber=l),type:"text",placeholder:"xxxx-xxxx-xxxx-xxxx",required:""},null,8,["modelValue"])]),_:1}),s(f,{id:"cardDate",class:"col-auto col-md-6",label:"有效期限","label-for":"cardDate"},{default:c(()=>[s(b,{id:"cardDate",modelValue:t.form.cardDate,"onUpdate:modelValue":a[11]||(a[11]=l=>t.form.cardDate=l),type:"text",placeholder:"MM/YY",required:""},null,8,["modelValue"])]),_:1}),s(f,{id:"cvc",class:"col-auto col-md-2",label:"CVC","label-for":"cvc"},{default:c(()=>[s(b,{id:"cvc",modelValue:t.form.cvc,"onUpdate:modelValue":a[12]||(a[12]=l=>t.form.cvc=l),type:"cvc",placeholder:"xxx",required:""},null,8,["modelValue"])]),_:1}),e("div",te,[e("button",{onClick:a[13]||(a[13]=l=>r.pageHandler("del")),class:"btn btn-dark w-100",type:"button"}," 上一步 "),se])]),_:1})])],2),e("div",{class:h(`col-auto col-md-8 flex-grow-1 order-1 order-md-0 ${t.page===4?"d-block":"d-none"}`)},[e("div",oe,[de,ne,e("ul",re,[(x(!0),_(k,null,w(t.cartDataInstance.cartData,(l,p)=>(x(),_("li",{key:p},[e("div",ce,[e("div",null,[e("img",{class:"img-box-2",src:l==null?void 0:l.image,alt:l==null?void 0:l.name},null,8,ue)]),e("div",be,[e("p",fe,o(l==null?void 0:l.name),1),e("small",null,o(l==null?void 0:l.date),1),e("small",null,o(l==null?void 0:l.ticketType.ticketType),1)]),e("p",null,"數量："+o(l==null?void 0:l.quantity),1),e("p",ie," NT$ "+o((l==null?void 0:l.price)*(l==null?void 0:l.quantity)),1),pe])]))),128))]),me,e("ul",_e,[e("li",null,"收件者： "+o(t.form.name),1),e("li",null,"信箱： "+o(t.form.email),1),e("li",null,"電話： "+o(t.form.tel),1),e("li",null,"地址： "+o(t.form.address),1),e("li",null," 信用卡："+o(t.form.cardNumber.split("").map((l,p)=>p<4?l:"*").join("")),1)]),e("div",xe,[e("button",{onClick:a[15]||(a[15]=l=>r.pageHandler("del")),class:"btn btn-dark w-100",type:"button"}," 上一步 "),s(q,{class:"d-block btn btn-dark w-100",to:"/user/orderSearch",onClick:r.onSubmit},{default:c(()=>[y(" 完成訂單 ")]),_:1},8,["onClick"])])])],2),e("section",he,[e("div",ve,[ye,e("ul",ge,[e("li",ke,[we,e("p",null,"$ "+o(r.total)+" NTD",1)]),De,Ve,qe]),Ne,e("div",Ie,[Ce,e("p",Te,"NTD $ "+o(r.total),1)])])])])])}const Ue=N(U,[["render",He],["__scopeId","data-v-b7df47fe"]]);export{Ue as default};
